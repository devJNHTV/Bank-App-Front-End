<div class="loan-detail-container">
  <div class="loading-spinner" *ngIf="loading">
    <div class="spinner"></div>
  </div>

  <div class="error-message" *ngIf="error">
    {{ error }}
  </div>

  <div class="loan-detail-content" *ngIf="loanDetail && !loading">
    <div class="loan-header">
      <h1>Loan Details</h1>
      <div class="loan-status" [ngClass]="loanDetail.status?.toLowerCase()">
        {{ loanDetail.status }}
      </div>
    </div>

    <div class="loan-info-section">
      <h2>Basic Information</h2>
      <div class="info-grid">
        <div class="info-item">
          <label>Loan ID</label>
          <span>{{ loanDetail.loanId }}</span>
        </div>
        <div class="info-item">
          <label>Account Number</label>
          <span>{{ loanDetail.accountNumber }}</span>
        </div>
        <div class="info-item">
          <label>Loan Amount</label>
          <span>{{ formatCurrency(loanDetail.amount) }}</span>
        </div>
        <div class="info-item">
          <label>Interest Rate</label>
          <span>{{ loanDetail.interestRate }}%</span>
        </div>
        <div class="info-item">
          <label>Term (Months)</label>
          <span>{{ loanDetail.termMonths }}</span>
        </div>
        <div class="info-item">
          <label>Declared Income</label>
          <span>{{ formatCurrency(loanDetail.declaredIncome) }}</span>
        </div>
        <div class="info-item">
          <label>Created Date</label>
          <span>{{ formatDate(loanDetail.createdAt) }}</span>
        </div>
        <div class="info-item" *ngIf="loanDetail.approvedAt">
          <label>Approved Date</label>
          <span>{{ formatDate(loanDetail.approvedAt) }}</span>
        </div>
      </div>
    </div>

    <div class="repayment-schedule-section" *ngIf="loanDetail.repayments">
      <h2>Repayment Schedule</h2>
      <div class="repayment-table">
        <table>
          <thead>
            <tr>
              <th>Due Date</th>
              <th>Principal</th>
              <th>Interest</th>
              <th>Total Due</th>
              <th>Paid Amount</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let repayment of loanDetail.repayments">
              <td>{{ formatDate(repayment.dueDate) }}</td>
              <td>{{ formatCurrency(repayment.principal) }}</td>
              <td>{{ formatCurrency(repayment.interest) }}</td>
              <td>{{ formatCurrency(repayment.principal + repayment.interest) }}</td>
              <td>{{ formatCurrency(repayment.paidAmount) }}</td>
              <td>
                <span class="status-badge" [ngClass]="getStatusClass(repayment.status)">
                  {{ repayment.status }}
                </span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="rejection-reasons" *ngIf="loanDetail.rejectionReasons && loanDetail.rejectionReasons.length > 0">
      <h2>Rejection Reasons</h2>
      <ul>
        <li *ngFor="let reason of loanDetail.rejectionReasons">{{ reason.reason }}</li>
      </ul>
    </div>
  </div>
</div>
