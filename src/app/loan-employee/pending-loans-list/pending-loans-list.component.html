<div class="loan-detail-view-container">
  <div class="header">
    <div class="header-content">
      <h1>Danh sách khoản vay đang chờ duyệt</h1>
      <p class="subtitle">Xem xét và xử lý các đơn vay</p>
    </div>
    <p-button 
      icon="pi pi-refresh" 
      label="Làm mới" 
      (onClick)="loadPendingLoans()"
      [loading]="loading"
      class="refresh-button">
    </p-button>
  </div>

  <div class="content-wrapper">
    <div class="loading-overlay" *ngIf="loading">
      <p-progressSpinner strokeWidth="6"></p-progressSpinner>
    </div>

    <div class="error-banner" *ngIf="error">
      <i class="pi pi-exclamation-triangle"></i>
      <span>{{ error }}</span>
    </div>

    <div class="no-data" *ngIf="!loading && pendingLoans.length === 0">
      <i class="pi pi-inbox"></i>
      <h3>Không có đơn vay đang chờ</h3>
      <p>Hiện tại không có đơn vay nào đang chờ xét duyệt.</p>
    </div>

    <p-table 
      *ngIf="!loading && pendingLoans.length > 0"
      [value]="pendingLoans"
      [paginator]="true"
      [rows]="10"
      [showCurrentPageReport]="true"
      currentPageReportTemplate="Hiển thị {first} đến {last} trong tổng số {totalRecords} mục"
      [rowsPerPageOptions]="[10,25,50]"
      styleClass="p-datatable-gridlines"
      [tableStyle]="{'min-width': '50rem'}"
      [globalFilterFields]="['loanId','accountNumber','amount','interestRate','termMonths','createdAt']">
      
      <ng-template pTemplate="caption">
        <div class="table-header">
          <h2>Danh sách đơn vay</h2>
          <span class="p-input-icon-left">
            <i class="pi pi-search"></i>
            <input 
              pInputText 
              type="text" 
              placeholder="Tìm kiếm..." />
          </span>
        </div>
      </ng-template>

      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="loanId">Mã <p-sortIcon field="loanId"></p-sortIcon></th>
          <th pSortableColumn="accountNumber">Số TK <p-sortIcon field="accountNumber"></p-sortIcon></th>
          <th pSortableColumn="amount">Số tiền <p-sortIcon field="amount"></p-sortIcon></th>
          <th pSortableColumn="interestRate">Lãi suất <p-sortIcon field="interestRate"></p-sortIcon></th>
          <th pSortableColumn="termMonths">Kỳ hạn <p-sortIcon field="termMonths"></p-sortIcon></th>
          <th pSortableColumn="createdAt">Ngày tạo <p-sortIcon field="createdAt"></p-sortIcon></th>
          <th>Thao tác</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-loan>
        <tr>
          <td>{{ loan.loanId }}</td>
          <td>{{ loan.accountNumber }}</td>
          <td>{{ formatCurrency(loan.amount) }}</td>
          <td>{{ loan.interestRate }}%</td>
          <td>{{ loan.termMonths }} tháng</td>
          <td>{{ formatDate(loan.createdAt) }}</td>
          <td>
            <p-button 
              icon="pi pi-eye" 
              label="Xem chi tiết" 
              (onClick)="goToLoanDetail(loan.loanId!)"
              class="p-button-outlined">
            </p-button>
          </td>
        </tr>
      </ng-template>

      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="7" class="text-center">Không tìm thấy đơn vay nào đang chờ duyệt.</td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>
  